# JWT 기능 설계

## 고려해야 하는 부분

 - __헤더와 페이로드 인코딩__
    - Base64Url 인코딩: 헤더와 페이로드를 Base64Url로 인코딩해야 합니다. 이 과정에서 패딩(=)을 생략해야 합니다.
    - JSON 형식: 헤더와 페이로드는 JSON 형식으로 인코딩되어야 합니다.
 - __서명 생성 및 검증__
   - 알고리즘 선택: 적절한 서명 알고리즘을 선택하고 지원해야 합니다. 일반적으로 HMAC SHA256(HS256)이나 RSA SHA256(RS256)이 많이 사용됩니다.
   - 비밀 키 관리: 서명에 사용되는 비밀 키는 안전하게 관리되어야 합니다. 키가 유출되지 않도록 주의해야 합니다.
   - 서명 검증: 토큰을 검증할 때 서명이 유효한지 반드시 확인해야 합니다.
 - __클레임 검증__
   - 필수 클레임: JWT 표준에 따라 등록된 클레임(exp, iat, nbf 등)을 적절히 검증해야 합니다.
     - exp (만료 시간): 현재 시간이 만료 시간을 초과하지 않았는지 확인합니다.
     - iat (발급 시간): 토큰이 발급된 시간을 검증합니다.
     - nbf (유효 시작 시간): 토큰이 지정된 시간 이후에만 유효한지 확인합니다.
   - 사용자 정의 클레임: 애플리케이션에서 필요한 사용자 정의 클레임을 검증합니다.
 - __보안 고려사항__
   - 알고리즘 공격 방지: 토큰에서 지정한 알고리즘을 맹목적으로 신뢰하지 않고, 허용된 알고리즘 목록을 사용하여 검증합니다.
   - 비밀 키 관리: 비밀 키는 안전한 장소에 저장하고, 필요시 주기적으로 변경합니다.
   - 재발급 및 무효화: JWT의 만료 시간(exp)을 짧게 설정하고, 토큰 재발급 및 무효화 메커니즘을 구축합니다.
   - CSRF 보호: JWT가 브라우저 쿠키에 저장되는 경우, CSRF(Cross-Site Request Forgery) 공격에 대비하여 보호 조치를 취합니다.
 - __성능 최적화__
   - 토큰 크기 관리: 불필요하게 큰 페이로드를 피하여 토큰 크기를 최적화합니다.
   - 캐싱: 토큰 검증 결과를 캐싱하여 성능을 최적화할 수 있습니다. 단, 보안에 주의해야 합니다.

<br/>

## 필수 기능

 - __토큰 생성 기능__
   - 헤더, 페이로드, 서명 생성: 헤더와 페이로드를 인코딩하고, 서명을 생성하여 토큰을 만듭니다.
   - 유효 기간 설정: 만료 시간(exp)과 발급 시간(iat) 등의 클레임을 설정할 수 있어야 합니다.
   - 지원 알고리즘: HMAC, RSA 등 다양한 서명 알고리즘을 지원해야 합니다.
 - __토큰 검증 기능__
   - 서명 검증: 토큰의 서명을 검증하여 무결성을 확인합니다.
   - 클레임 검증: exp, iat, nbf 등의 클레임을 검증합니다.
   - 알고리즘 확인: 허용된 알고리즘을 사용하여 서명이 생성되었는지 확인합니다.
 - __클레임 관리 기능__
   - 클레임 추가: 페이로드에 클레임을 추가할 수 있어야 합니다.
   - 클레임 제거: 필요 없는 클레임을 제거할 수 있어야 합니다.
   - 클레임 조회: 페이로드에서 특정 클레임의 값을 조회할 수 있어야 합니다.
 - __인코딩 및 디코딩 기능__
   - Base64Url 인코딩 및 디코딩: JWT의 각 부분을 Base64Url 형식으로 인코딩하고 디코딩할 수 있어야 합니다.
   - JSON 직렬화 및 역직렬화: JSON 형식으로 데이터를 직렬화하고 역직렬화할 수 있어야 합니다.
 - __유틸리티 기능__
   - 토큰 파싱: JWT 문자열을 헤더, 페이로드, 서명으로 분리할 수 있어야 합니다.
   - 시간 처리: 클레임의 시간 값(exp, iat, nbf)을 처리할 수 있는 유틸리티 함수가 필요합니다.
 - __보안 기능__
   - 알고리즘 공격 방지: 토큰에서 지정한 알고리즘을 맹목적으로 신뢰하지 않고, 허용된 알고리즘 목록을 사용하여 검증합니다.
   - 비밀 키 관리: 비밀 키를 안전하게 관리할 수 있는 기능이 필요합니다.
   - 재발급 및 무효화: 토큰을 재발급하거나 무효화할 수 있는 기능이 필요합니다.

